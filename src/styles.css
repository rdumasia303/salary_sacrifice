@tailwind base;
@tailwind components;
@tailwind utilities;

/* Tailwind directives are processed by Vite/PostCSS at build time. Editor may show unknown at-rule warnings. */

html, body, #root {
  height: 100%;
  /* Safari smooth scrolling */
  -webkit-overflow-scrolling: touch;
  /* Prevent horizontal scroll on Safari */
  overflow-x: hidden;
}

/* Aurora plus subtle animated tech grid */
.gradient-aurora {
  background:
    radial-gradient(40% 50% at 10% 10%, rgba(124,58,237,0.12), transparent 60%),
    radial-gradient(40% 50% at 90% 0%, rgba(6,182,212,0.10), transparent 60%),
    radial-gradient(60% 60% at 50% 100%, rgba(34,197,94,0.08), transparent 60%),
    linear-gradient(180deg, #070b10 0%, #0b0f14 40%, #0e141c 60%, #070b10 100%);
  background-attachment: fixed;
}

/* Neon grid overlay */
.bg-techgrid::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image:
    linear-gradient(rgba(124,58,237,0.08) 1px, transparent 1px),
    linear-gradient(90deg, rgba(6,182,212,0.08) 1px, transparent 1px);
  background-size: 120px 120px;
  pointer-events: none;
  z-index: 0;
  animation: gridpan 20s linear infinite;
}

/* Solid panels */
.glass {
  position: relative;
  background-color: rgba(10, 14, 20, 0.92);
  backdrop-filter: blur(12px);
  border: 1px solid rgba(124,58,237,0.25);
}
/* Deeper, darker panels for input areas */
.glass-deep {
  position: relative;
  background-color: rgba(4, 6, 10, 0.94);
  backdrop-filter: blur(14px);
  border: 1px solid rgba(124,58,237,0.32);
}
.glass::after,
.glass-deep::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
  box-shadow: 0 0 0 1px rgba(6,182,212,0.18) inset, 0 10px 30px rgba(0,0,0,0.45);
}

.card {
  position: relative;
  background-color: rgba(10, 14, 20, 0.92);
  backdrop-filter: blur(12px);
  border: 1px solid rgba(124,58,237,0.25);
  border-radius: 1rem;
  box-shadow: 0 10px 30px rgba(0,0,0,0.6);
}

/* Reserve heights for dynamic blocks to prevent layout shift */
.block-stable { min-height: 140px; }
.pie-stable { min-height: 300px; }
.alert-stable { min-height: 56px; }

/* Scanlines overlay for subtle cyberpunk vibe */
.scanlines {
  pointer-events: none;
  position: fixed;
  inset: 0;
  background-image: linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px);
  background-size: 100% 2px;
  opacity: 0.4;
  mix-blend-mode: overlay;
  z-index: 1;
}

/* Neon glow helpers */
.neon-primary { box-shadow: 0 0 12px rgba(124,58,237,0.35), 0 0 24px rgba(124,58,237,0.2); }
.neon-secondary { box-shadow: 0 0 12px rgba(6,182,212,0.35), 0 0 24px rgba(6,182,212,0.2); }
.neon-accent { box-shadow: 0 0 12px rgba(34,197,94,0.35), 0 0 24px rgba(34,197,94,0.2); }

/* Button hover glow */
.btn:hover { filter: drop-shadow(0 0 10px rgba(124,58,237,0.35)); }

/* Inputs subtle glow */
.input, .select, .range {
  border-color: rgba(124,58,237,0.25) !important;
}
.input:focus, .select:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(124,58,237,0.35);
}

/* Fix dropdown text visibility */
.select {
  color: white !important;
}
.select option {
  background-color: rgb(31, 41, 55) !important;
  color: white !important;
}

/* Accent corners */
.corner-accent {
  position: relative;
}
.corner-accent::before,
.corner-accent::after {
  content: '';
  position: absolute;
  width: 14px; height: 14px;
  border: 2px solid rgba(6,182,212,0.6);
}
.corner-accent::before { top: 8px; left: 8px; border-right: none; border-bottom: none; }
.corner-accent::after { bottom: 8px; right: 8px; border-left: none; border-top: none; }

/* Safari-specific optimizations and fixes */
@supports (-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px)) {
  /* Force GPU acceleration for animated elements in Safari */
  .animate-aurora,
  .animate-glowpulse,
  .animate-fadeIn {
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
  }

  /* Optimize will-change for animated properties */
  .animate-aurora {
    will-change: opacity;
  }

  .animate-glowpulse {
    will-change: box-shadow;
  }

  .animate-fadeIn {
    will-change: opacity;
  }

  /* Safari backdrop-filter fix - add explicit webkit prefix */
  .glass,
  .glass-deep,
  .card {
    -webkit-backdrop-filter: blur(12px);
    backdrop-filter: blur(12px);
  }
}

/* Safari flexbox fixes */
.flex {
  /* Fix Safari flex shrink issues */
  min-width: 0;
  min-height: 0;
}

/* Safari grid fixes */
.grid {
  /* Ensure grid items don't overflow in Safari */
  min-width: 0;
}

/* Safari-specific input fixes */
@supports (-webkit-appearance: none) {
  /* Fix Safari input rendering */
  .input,
  .select {
    -webkit-appearance: none;
    appearance: none;
  }

  /* Fix Safari select arrow */
  .select {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3E%3C/svg%3E");
    background-position: right 0.5rem center;
    background-repeat: no-repeat;
    background-size: 1.5em 1.5em;
    padding-right: 2.5rem;
  }

  /* Fix Safari range slider */
  .range {
    -webkit-appearance: none;
    appearance: none;
  }

  .range::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
  }
}

/* Respect user's motion preferences */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }

  .animate-aurora,
  .animate-glowpulse,
  .animate-fadeIn {
    animation: none !important;
  }
}

/* Additional Safari-specific fixes for iOS devices */
@supports (-webkit-touch-callout: none) {
  /* Fix iOS Safari 100vh issue */
  html {
    height: -webkit-fill-available;
  }

  body, #root {
    min-height: 100vh;
    min-height: -webkit-fill-available;
  }

  /* Fix Safari font rendering */
  * {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Fix Safari position fixed with backdrop-filter */
  .glass::after,
  .glass-deep::after {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
  }
}

/* Safari desktop-specific fixes */
@supports (not (-webkit-touch-callout: none)) and (-webkit-appearance: none) {
  /* Desktop Safari backdrop-filter performance */
  .glass,
  .glass-deep,
  .card {
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000;
    perspective: 1000;
  }
}
